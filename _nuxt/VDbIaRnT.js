import{X as Q,l as A,r as k,f as I,o as r,c as u,Q as U,R as D,y as b,Y as j,u as l,a as m,I as q,t as T,Z as C,n as O,q as M,$ as Y,U as F,e as E,a0 as L,k as X,b as x,H as Z,w as S,S as G,d as R,m as J,a1 as K}from"./BN0B7Lbi.js";import{_ as W}from"./COtIGsMs.js";import{_ as ee}from"./DVm2ogqK.js";import{_ as te}from"./-fhrnqg4.js";import{_ as se}from"./wtzRrliu.js";import{_ as le}from"./Bo3vZDjX.js";import{c as ae}from"./Bd64R_8f.js";import{u as oe}from"./D-Ko8XmK.js";import{u as ne}from"./BhzR2afx.js";import{u as re}from"./xdM59Akf.js";import{u as ie}from"./Ju0TuKTv.js";import"./D_wO4cs_.js";import"./Ag6tYbTR.js";function ue(V,y){const{title:p,titleTemplate:_,...e}=V;return ie({title:p,titleTemplate:_,_flatMeta:e},{...y,transform(d){const g=Q({...d._flatMeta});return delete d._flatMeta,{...d,meta:g}}})}const de={key:0,class:"space-y-2"},me=["name","value"],ce={class:"text-sm"},pe={key:1,class:"space-y-2"},fe={class:"mb-1 text-sm"},ve=["min","max"],ye={key:2},_e=["min","max"],ge={key:3},be={key:4,class:"flex flex-col gap-1"},qe={key:0,class:"text-sm text-red-500"},xe={key:5,class:"flex flex-col gap-1"},we=["value"],he=A({__name:"DynamicInput",props:{q:{},modelValue:{}},emits:["update:modelValue"],setup(V,{emit:y}){const p=V,_=y,e=k(p.modelValue??(p.q.questionType==="multiselect"?[]:""));I(e,s=>_("update:modelValue",s)),I(()=>p.modelValue,s=>e.value=s);const d=k(""),g=()=>{p.q.questionType==="email"&&(e.value?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.value)?d.value="":d.value="Please enter a valid email address.":d.value="Email is required.")};return(s,a)=>(r(),u("div",null,[s.q.questionType==="radio"?(r(),u("div",de,[(r(!0),u(U,null,D(s.q.options,t=>(r(),u("div",{key:t.value,class:"flex items-center space-x-2"},[b(m("input",{type:"radio",name:s.q.question,value:t.value,"onUpdate:modelValue":a[0]||(a[0]=$=>q(e)?e.value=$:null),class:"accent-primary"},null,8,me),[[j,l(e)]]),m("label",ce,T(t.label),1)]))),128))])):s.q.questionType==="slider"?(r(),u("div",pe,[m("div",fe,"Selected: "+T(l(e)),1),b(m("input",{type:"range",min:s.q.min,max:s.q.max,"onUpdate:modelValue":a[1]||(a[1]=t=>q(e)?e.value=t:null),class:"w-full accent-primary"},null,8,ve),[[C,l(e),void 0,{number:!0}]])])):s.q.questionType==="number"?(r(),u("div",ye,[b(m("input",{type:"number","onUpdate:modelValue":a[2]||(a[2]=t=>q(e)?e.value=t:null),min:s.q.min,max:s.q.max,class:"w-full p-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary"},null,8,_e),[[C,l(e),void 0,{number:!0}]])])):s.q.questionType==="text"?(r(),u("div",ge,[b(m("input",{type:"text","onUpdate:modelValue":a[3]||(a[3]=t=>q(e)?e.value=t:null),placeholder:"Enter text...",class:"w-full p-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary"},null,512),[[C,l(e)]])])):s.q.questionType==="email"?(r(),u("div",be,[b(m("input",{type:"email","onUpdate:modelValue":a[4]||(a[4]=t=>q(e)?e.value=t:null),placeholder:"Enter your email...",onBlur:g,class:O(["w-full p-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary",{"border-red-500 focus:ring-red-500":l(d)}])},null,34),[[C,l(e)]]),l(d)?(r(),u("p",qe,T(l(d)),1)):M("",!0)])):s.q.questionType==="multiselect"?(r(),u("div",xe,[b(m("select",{multiple:"","onUpdate:modelValue":a[5]||(a[5]=t=>q(e)?e.value=t:null),class:"w-full p-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary"},[(r(!0),u(U,null,D(s.q.options,t=>(r(),u("option",{key:t.value,value:t.value},T(t.label),9,we))),128))],512),[[Y,l(e)]]),a[6]||(a[6]=m("p",{class:"text-xs text-gray-500"},"Hold Ctrl (Cmd on Mac) to select multiple",-1))])):M("",!0)]))}}),Te={key:0,class:"container relative content-center min-h-screen pt-10 pb-32"},ke={class:"relative flex flex-col gap-6 lg:flex-row"},Ve={class:"flex w-full mt-8"},$e={class:"sticky grid w-full h-full gap-3 top-32 lg:w-1/2"},ze=A({__name:"index",async setup(V){let y,p;const _=F(),e=k(""),d=oe(),g=k(null),s=E(()=>ne.find(n=>{var o;return((o=n==null?void 0:n.type)==null?void 0:o.toUpperCase())===e.value.toUpperCase()})||null),a=E(()=>{var n;return((n=s.value)==null?void 0:n.questions)||[]}),t=k([]),{data:$,error:B}=([y,p]=L(()=>re("posts",()=>d.fetchCollection("posts",1,5,"","-created"))),y=await y,p(),y),P=(n,o)=>{d==null||d.createItem("inbox",{email:n||"default@example.com",message:o})};$.value&&(g.value=$.value),B.value&&console.error("Error fetching posts:",B.value);const H=E(()=>{var c,f;const n=((c=s.value)==null?void 0:c.type)||"Default Title",o=((f=s.value)==null?void 0:f.description)||"Default description";return ae({title:n,summary:o,imageUri:"",pubDate:new Date().toISOString(),byline:"RelocateToSanCarlos"})});ue(H.value),I(a,n=>{t.value=n.map(o=>o.questionType==="slider"||o.questionType==="number"?0:"")},{immediate:!0});const N=()=>{if(a.value.some((o,c)=>o.questionType==="email"&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t.value[c]))){alert("Please fix invalid email addresses before submitting.");return}try{const o=a.value.map((v,i)=>`${v.question}: ${t.value[i]}`).join(`
`),c=a.value.findIndex(v=>v.questionType==="email"),f=c>=0?t.value[c]:"onboardingQuestions@relocatetosancarlos.com";P(f,o),alert("Your responses have been submitted successfully!"),t.value=a.value.map(v=>v.questionType==="slider"||v.questionType==="number"?0:""),K().push("/")}catch(o){console.error("Error submitting form:",o),alert("There was an error submitting your responses. Please try again.")}console.log("Collected Answers:",t.value)};return X(()=>{var c,f;const n=Array.isArray((c=_.params)==null?void 0:c.type)?_.params.type[0]:(f=_.params)==null?void 0:f.type,o=n==null?void 0:n.replace(/-/g," ").replace(/\b\w/g,w=>w.toUpperCase());e.value=o}),(n,o)=>{var w,v;const c=he,f=W;return(w=l(s))!=null&&w.type?(r(),u("div",Te,[x(ee,{class:"mb-8",title:l(s).type,description:l(s).description,type:"h1"},null,8,["title","description"]),m("div",ke,[l(a).length?(r(),u("form",{key:0,class:"w-full lg:w-1/2",onSubmit:Z(N,["prevent"])},[x(l(te),{class:"flex flex-col gap-4 p-8"},{default:S(()=>[(r(!0),u(U,null,D(l(a),(i,h)=>(r(),u("div",{key:h},[x(l(le),{class:"mb-4 text-lg font-semibold"},{default:S(()=>[R(T(i.question),1)]),_:2},1024),x(l(se),null,{default:S(()=>[x(c,{modelValue:l(t)[h],"onUpdate:modelValue":z=>l(t)[h]=z,q:i},null,8,["modelValue","onUpdate:modelValue","q"])]),_:2},1024)]))),128))]),_:1}),m("div",Ve,[x(l(G),{class:"w-full text-lg font-bold",variant:"outline",size:"lg",type:"submit",disabled:!l(t).every(i=>i!==void 0&&i!==""&&i!==null)},{default:S(()=>o[0]||(o[0]=[R(" Submit ")])),_:1},8,["disabled"])])],32)):M("",!0),m("div",$e,[o[1]||(o[1]=m("h2",{class:""},"Related Posts",-1)),(r(!0),u(U,null,D((v=l(g))==null?void 0:v.items,(i,h)=>(r(),J(f,{key:i.id,title:i.title,description:i.description,created:i.created,slug:i.slug,"collection-id":i.collectionId,id:i.id,"cover-image":i.cover_image,index:h},null,8,["title","description","created","slug","collection-id","id","cover-image","index"]))),128))])])])):M("",!0)}}});export{ze as default};
