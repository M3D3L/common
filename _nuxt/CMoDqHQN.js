import{o as q,u as B,S as y,g as R,h as D,P as U,b as $}from"./2cAMmKoA.js";import{r as p,e as A,ab as k,al as G,l as T,f as L,ac as _,j,am as V,x as K,o as z,m as Y,w as h,b as H,u as w,p as J}from"./BN0B7Lbi.js";function Q(e){const o=q({dir:p("ltr")});return A(()=>{var r;return(e==null?void 0:e.value)||((r=o.dir)==null?void 0:r.value)||"ltr"})}function x(){const e=p(),o=A(()=>{var r,t;return["#text","#comment"].includes((r=e.value)==null?void 0:r.$el.nodeName)?(t=e.value)==null?void 0:t.$el.nextElementSibling:B(e)});return{primitiveElement:e,currentElement:o}}const M="data-reka-collection-item";function W(e={}){const{key:o="",isProvider:r=!1}=e,t=`${o}CollectionProvider`;let n;if(r){const s=p(new Map);n={collectionRef:p(),itemMap:s},k(t,n)}else n=G(t);const I=(s=!1)=>{const a=n.collectionRef.value;if(!a)return[];const l=Array.from(a.querySelectorAll(`[${M}]`)),c=Array.from(n.itemMap.value.values()).sort((f,v)=>l.indexOf(f.ref)-l.indexOf(v.ref));return s?c:c.filter(f=>f.ref.dataset.disabled!=="")},S=T({name:"CollectionSlot",setup(s,{slots:a}){const{primitiveElement:l,currentElement:u}=x();return L(u,()=>{n.collectionRef.value=u.value}),()=>_(y,{ref:l},a)}}),F=T({name:"CollectionItem",inheritAttrs:!1,props:{value:{validator:()=>!0}},setup(s,{slots:a,attrs:l}){const{primitiveElement:u,currentElement:c}=x();return j(f=>{if(c.value){const v=V(c.value);n.itemMap.value.set(v,{ref:c.value,value:s.value}),f(()=>n.itemMap.value.delete(v))}}),()=>_(y,{...l,[M]:"",ref:u},a)}}),b=A(()=>Array.from(n.itemMap.value.values())),g=A(()=>n.itemMap.value.size);return{getItems:I,reactiveItems:b,itemMapSize:g,CollectionSlot:S,CollectionItem:F}}const X="rovingFocusGroup.onEntryFocus",Z={bubbles:!1,cancelable:!0},ee={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function te(e,o){return o!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function le(e,o,r){const t=te(e.key,r);if(!(o==="vertical"&&["ArrowLeft","ArrowRight"].includes(t))&&!(o==="horizontal"&&["ArrowUp","ArrowDown"].includes(t)))return ee[t]}function oe(e,o=!1){const r=R();for(const t of e)if(t===r||(t.focus({preventScroll:o}),R()!==r))return}function ie(e,o){return e.map((r,t)=>e[(o+t)%e.length])}const[ue,re]=$("RovingFocusGroup");var ne=T({__name:"RovingFocusGroup",props:{orientation:{type:String,required:!1,default:void 0},dir:{type:String,required:!1},loop:{type:Boolean,required:!1,default:!1},currentTabStopId:{type:[String,null],required:!1},defaultCurrentTabStopId:{type:String,required:!1},preventScrollOnEntryFocus:{type:Boolean,required:!1,default:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["entryFocus","update:currentTabStopId"],setup(e,{expose:o,emit:r}){const t=e,n=r,{loop:I,orientation:S,dir:F}=K(t),b=Q(F),g=D(t,"currentTabStopId",n,{defaultValue:t.defaultCurrentTabStopId,passive:t.currentTabStopId===void 0}),s=p(!1),a=p(!1),l=p(0),{getItems:u,CollectionSlot:c}=W({isProvider:!0});function f(i){const m=!a.value;if(i.currentTarget&&i.target===i.currentTarget&&m&&!s.value){const E=new CustomEvent(X,Z);if(i.currentTarget.dispatchEvent(E),n("entryFocus",E),!E.defaultPrevented){const C=u().map(d=>d.ref).filter(d=>d.dataset.disabled!==""),P=C.find(d=>d.getAttribute("data-active")===""),O=C.find(d=>d.id===g.value),N=[P,O,...C].filter(Boolean);oe(N,t.preventScrollOnEntryFocus)}}a.value=!1}function v(){setTimeout(()=>{a.value=!1},1)}return o({getItems:u}),re({loop:I,dir:b,orientation:S,currentTabStopId:g,onItemFocus:i=>{g.value=i},onItemShiftTab:()=>{s.value=!0},onFocusableItemAdd:()=>{l.value++},onFocusableItemRemove:()=>{l.value--}}),(i,m)=>(z(),Y(w(c),null,{default:h(()=>[H(w(U),{tabindex:s.value||l.value===0?-1:0,"data-orientation":w(S),as:i.as,"as-child":i.asChild,dir:w(b),style:{outline:"none"},onMousedown:m[0]||(m[0]=E=>a.value=!0),onMouseup:v,onFocus:f,onBlur:m[1]||(m[1]=E=>s.value=!1)},{default:h(()=>[J(i.$slots,"default")]),_:3},8,["tabindex","data-orientation","as","as-child","dir"])]),_:3}))}}),ce=ne;export{ce as R,W as a,oe as f,le as g,ue as i,Q as u,ie as w};
