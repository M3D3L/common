import{x as O,i as S,y as U,u as C}from"./2cAMmKoA.js";import{r as d,f as E,G as P,v as b,e as x,l as _,x as w,ac as D,a8 as F}from"./BN0B7Lbi.js";function L(r,e){const o=d(r);function f(l){return e[o.value][l]??o.value}return{state:o,dispatch:l=>{o.value=f(l)}}}function R(r,e){var T;const o=d({}),f=d("none"),h=d(r),l=r.value?"mounted":"unmounted";let c;const i=((T=e.value)==null?void 0:T.ownerDocument.defaultView)??O,{state:m,dispatch:u}=L(l,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}}),s=t=>{var n;if(S){const p=new CustomEvent(t,{bubbles:!1,cancelable:!1});(n=e.value)==null||n.dispatchEvent(p)}};E(r,async(t,n)=>{var A;const p=n!==t;if(await P(),p){const M=f.value,v=y(e.value);t?(u("MOUNT"),s("enter"),v==="none"&&s("after-enter")):v==="none"||v==="undefined"||((A=o.value)==null?void 0:A.display)==="none"?(u("UNMOUNT"),s("leave"),s("after-leave")):n&&M!==v?(u("ANIMATION_OUT"),s("leave")):(u("UNMOUNT"),s("after-leave"))}},{immediate:!0});const a=t=>{const n=y(e.value),p=n.includes(t.animationName),A=m.value==="mounted"?"enter":"leave";if(t.target===e.value&&p&&(s(`after-${A}`),u("ANIMATION_END"),!h.value)){const M=e.value.style.animationFillMode;e.value.style.animationFillMode="forwards",c=i==null?void 0:i.setTimeout(()=>{var v;((v=e.value)==null?void 0:v.style.animationFillMode)==="forwards"&&(e.value.style.animationFillMode=M)})}t.target===e.value&&n==="none"&&u("ANIMATION_END")},N=t=>{t.target===e.value&&(f.value=y(e.value))},g=E(e,(t,n)=>{t?(o.value=getComputedStyle(t),t.addEventListener("animationstart",N),t.addEventListener("animationcancel",a),t.addEventListener("animationend",a)):(u("ANIMATION_END"),c!==void 0&&(i==null||i.clearTimeout(c)),n==null||n.removeEventListener("animationstart",N),n==null||n.removeEventListener("animationcancel",a),n==null||n.removeEventListener("animationend",a))},{immediate:!0}),I=E(m,()=>{const t=y(e.value);f.value=m.value==="mounted"?t:"none"});return b(()=>{g(),I()}),{isPresent:x(()=>["mounted","unmountSuspended"].includes(m.value))}}function y(r){return r&&getComputedStyle(r).animationName||"none"}var V=_({name:"Presence",props:{present:{type:Boolean,required:!0},forceMount:{type:Boolean}},slots:{},setup(r,{slots:e,expose:o}){var u;const{present:f,forceMount:h}=w(r),l=d(),{isPresent:c}=R(f,l);o({present:c});let i=e.default({present:c.value});i=U(i||[]);const m=F();if(i&&(i==null?void 0:i.length)>1){const s=(u=m==null?void 0:m.parent)!=null&&u.type.name?`<${m.parent.type.name} />`:"component";throw new Error([`Detected an invalid children for \`${s}\` for  \`Presence\` component.`,"","Note: Presence works similarly to `v-if` directly, but it waits for animation/transition to finished before unmounting. So it expect only one direct child of valid VNode type.","You can apply a few solutions:",["Provide a single child element so that `presence` directive attach correctly.","Ensure the first child is an actual element instead of a raw text node or comment node."].map(a=>`  - ${a}`).join(`
`)].join(`
`))}return()=>h.value||f.value||c.value?D(e.default({present:c.value})[0],{ref:s=>{const a=C(s);return typeof(a==null?void 0:a.hasAttribute)>"u"||(a!=null&&a.hasAttribute("data-reka-popper-content-wrapper")?l.value=a.firstElementChild:l.value=a),a}}):null}});export{V as P};
