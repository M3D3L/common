import{u as h}from"./Ag6tYbTR.js";import{a1 as m,U as d,ak as s,k as f,l as p,o as S,c as w,p as k,n as g,u as y,O as A}from"./BN0B7Lbi.js";function O(){const t=h();m(),d();const o=s("auth:user",()=>t.authStore.model?u():null),a=s("auth:isAuthenticated",()=>t.authStore.isValid);f(()=>{t.authStore.loadFromCookie((document==null?void 0:document.cookie)||"")});function u(){const e=t.authStore.model;return e?{id:e.id,email:e.email,username:e.username,...e}:null}t.authStore.onChange((e,r)=>{o.value=u(),a.value=t.authStore.isValid,document.cookie=t.authStore.exportToCookie({httpOnly:!1,sameSite:"lax",secure:!0,path:"/"})},!0);async function i(e){try{return await t.collection("users").create(e),await n({email:e.email,password:e.password})}catch(r){return console.error("Registration error:",r),!1}}async function n(e){try{if(await t.collection("users").authWithPassword(e.email,e.password),!t.authStore.isValid)throw new Error("Authentication failed");return!0}catch(r){return console.error("Login error:",r),!1}}async function c(e){try{const r=await t.collection("users").authWithOAuth2({provider:e});if(!t.authStore.isValid)throw new Error("OAuth authentication failed");return!0}catch(r){return console.error("OAuth login error:",r),!1}}async function l(){try{return t.authStore.clear(),document.cookie=t.authStore.exportToCookie({expires:new Date(0),path:"/"}),!0}catch(e){return console.error("Logout error:",e),!1}}return{user:o,isAuthenticated:a,register:i,login:n,loginWithOAuth:c,logout:l}}const _=p({__name:"CardFooter",props:{class:{}},setup(t){const o=t;return(a,u)=>(S(),w("div",{class:g(y(A)("flex items-center p-6 pt-0",o.class))},[k(a.$slots,"default")],2))}});export{_,O as u};
