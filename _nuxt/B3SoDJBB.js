import{_ as E}from"./BNifxBBp.js";import{_ as T}from"./DggF4A72.js";import{_ as I}from"./Z39OIrxf.js";import{l as N,e as k,r as U,U as O,a2 as D,W as S,o as i,m as M,w as r,b as o,a as u,u as e,d as c,c as d,q as m,H as F,t as p,y as z,aa as G,S as H}from"./DWH1ACXH.js";import{c as W,_ as Y}from"./DO1rN-p-.js";import{_ as J}from"./Cx3-yYNP.js";import{_ as K}from"./BICR719N.js";import{_ as Q,b as X,c as C}from"./CJmnXEKr.js";import{_ as v,a as g}from"./DMXWuP2W.js";import{u as Z}from"./BDLV6D-F.js";/**
 * @license lucide-vue-next v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=W("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),se={class:"flex items-center justify-center w-full h-full p-4 mx-auto md:max-w-3xl"},ae={class:"w-full"},te={class:"flex justify-center mb-6"},oe={key:0,class:"p-4 mb-4 text-center text-green-600 bg-green-100 rounded-md"},re={key:0,class:"space-y-2"},le={key:0,class:"text-sm text-destructive"},ie={class:"space-y-2"},ne={key:0,class:"text-sm text-destructive"},de={class:"space-y-2"},ue={key:0,class:"text-sm text-destructive"},me={key:1,class:"text-xs text-muted-foreground"},ce={key:1,class:"space-y-2"},fe={key:0,class:"text-sm text-destructive"},pe={key:2,class:"space-y-2"},_e={key:0,class:"text-sm text-destructive"},ve={key:3,class:"space-y-2"},we={key:0,class:"text-sm text-destructive"},ge={key:1,class:"mt-2"},ye=["src"],be={key:0,class:"flex items-center"},he={key:1},xe={class:"text-sm text-muted-foreground"},Re=N({__name:"AuthForm",setup(ke){const P=Z(),n=k(()=>b.path==="/register"),y=U(!1),b=O(),h=D(),V=k(()=>{const l=b.query.source;return l?String(l):"/"}),j=k(()=>n.value?"register":"login"),$=l=>{l==="register"&&b.path!=="/register"?h.push("/register"):l==="login"&&b.path!=="/login"&&h.push("/login")},a=S({username:"",email:"",password:"",confirmPassword:"",bio:"",avatar:null,avatarUrl:null,remember:!1}),t=S({}),x=U(!1),A=()=>{a.username="",a.email="",a.password="",a.confirmPassword="",a.bio="",a.avatar=null,a.avatarUrl=null,a.remember=!1;const l=document.getElementById("avatar");l&&(l.value="")},q=()=>(Object.keys(t).forEach(l=>delete t[l]),n.value&&(a.username||(t.username="Username is required")),a.email?/^\S+@\S+\.\S+$/.test(a.email)||(t.email="Please enter a valid email"):t.email="Email is required",a.password?n.value&&a.password.length<8&&(t.password="Password must be at least 8 characters"):t.password="Password is required",n.value&&(a.confirmPassword?a.password!==a.confirmPassword&&(t.confirmPassword="Passwords do not match"):t.confirmPassword="Please confirm your password"),Object.keys(t).length===0),L=l=>{const s=l.target;s.files&&s.files.length>0?(a.avatar=s.files[0],a.avatarUrl=URL.createObjectURL(s.files[0])):(a.avatar=null,a.avatarUrl=null)},R=async()=>{var l;if(q()){x.value=!0,y.value=!1;try{if(n.value){const s={email:a.email,password:a.password,passwordConfirm:a.confirmPassword,username:a.username,bio:a.bio};a.avatar&&(s.avatar=a.avatar),await P.register(s)&&(y.value=!0,A(),setTimeout(()=>{y.value=!1},5e3))}else await P.login({email:a.email,password:a.password})?V.value==="/"?await h.push("/"):await h.push(V.value):t.email="Invalid email or password"}catch(s){s.message&&((l=s.data)!=null&&l.data?Object.entries(s.data.data).forEach(([_,w])=>{_ in t&&(t[_]=Array.isArray(w)?w.join(", "):String(w))}):console.error("Registration/Login error:",s))}finally{x.value=!1}}};return(l,s)=>{const _=E,w=T,B=I;return i(),M(B,{video:"https://videos.pexels.com/video-files/2867873/2867873-uhd_2560_1440_24fps.mp4",class:"min-h-[90vh]"},{"video-container-content":r(()=>[o(w,null,{default:r(()=>[u("div",se,[u("div",ae,[o(e(Y),{class:"-mt-32 transition-all duration-300 shadow-lg bg-background/90 backdrop-blur-sm border-border/50"},{default:r(()=>[o(e(J),{class:"p-6"},{default:r(()=>[s[15]||(s[15]=u("div",{class:"flex justify-center mb-6"},[u("span",{class:"flex flex-col logo-text"},[u("span",{class:"text-xl font-bold"},"GuillermoMedel")])],-1)),u("div",te,[o(e(Q),{modelValue:e(j),class:"w-full","onUpdate:modelValue":$},{default:r(()=>[o(e(X),{class:"grid w-full grid-cols-2"},{default:r(()=>[o(e(C),{value:"login",asChild:""},{default:r(()=>[o(_,{to:"/login",class:"w-full"},{default:r(()=>s[5]||(s[5]=[c("Login")])),_:1})]),_:1}),o(e(C),{value:"register",asChild:""},{default:r(()=>[o(_,{to:"/register",class:"w-full"},{default:r(()=>s[6]||(s[6]=[c("Register")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),e(y)?(i(),d("div",oe,s[7]||(s[7]=[u("p",null,"Thank you for registering! You can now login with your credentials.",-1)]))):m("",!0),u("form",{onSubmit:F(R,["prevent"]),class:"space-y-4"},[e(n)?(i(),d("div",re,[o(e(v),{for:"username"},{default:r(()=>s[8]||(s[8]=[c("Username")])),_:1}),o(e(g),{id:"username",modelValue:e(a).username,"onUpdate:modelValue":s[0]||(s[0]=f=>e(a).username=f),placeholder:"johndoe",required:"",autocomplete:"username"},null,8,["modelValue"]),e(t).username?(i(),d("div",le,p(e(t).username),1)):m("",!0)])):m("",!0),u("div",ie,[o(e(v),{for:"email"},{default:r(()=>s[9]||(s[9]=[c("Email")])),_:1}),o(e(g),{id:"email",modelValue:e(a).email,"onUpdate:modelValue":s[1]||(s[1]=f=>e(a).email=f),type:"email",placeholder:"your@email.com",required:"",autocomplete:"email"},null,8,["modelValue"]),e(t).email?(i(),d("div",ne,p(e(t).email),1)):m("",!0)]),u("div",de,[o(e(v),{for:"password"},{default:r(()=>s[10]||(s[10]=[c("Password")])),_:1}),o(e(g),{id:"password",modelValue:e(a).password,"onUpdate:modelValue":s[2]||(s[2]=f=>e(a).password=f),type:"password",placeholder:"••••••••",required:"",minlength:e(n)?8:1,autocomplete:"current-password"},null,8,["modelValue","minlength"]),e(t).password?(i(),d("div",ue,p(e(t).password),1)):m("",!0),e(n)?(i(),d("div",me," Password must be at least 8 characters ")):m("",!0)]),e(n)?(i(),d("div",ce,[o(e(v),{for:"confirmPassword"},{default:r(()=>s[11]||(s[11]=[c("Confirm Password")])),_:1}),o(e(g),{id:"confirmPassword",modelValue:e(a).confirmPassword,"onUpdate:modelValue":s[3]||(s[3]=f=>e(a).confirmPassword=f),type:"password",placeholder:"••••••••",required:"",minlength:"8",autocomplete:"new-password"},null,8,["modelValue"]),e(t).confirmPassword?(i(),d("div",fe,p(e(t).confirmPassword),1)):m("",!0)])):m("",!0),e(n)?(i(),d("div",pe,[o(e(v),{for:"bio"},{default:r(()=>s[12]||(s[12]=[c("Bio")])),_:1}),z(u("textarea",{id:"bio","onUpdate:modelValue":s[4]||(s[4]=f=>e(a).bio=f),class:"w-full px-3 py-2 text-sm border rounded-md border-input bg-background ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",placeholder:"A short bio about yourself"},null,512),[[G,e(a).bio]]),e(t).bio?(i(),d("div",_e,p(e(t).bio),1)):m("",!0)])):m("",!0),e(n)?(i(),d("div",ve,[o(e(v),{for:"avatar"},{default:r(()=>s[13]||(s[13]=[c("Avatar")])),_:1}),o(e(g),{id:"avatar",type:"file",onChange:L,accept:"image/*"}),e(t).avatar?(i(),d("div",we,p(e(t).avatar),1)):m("",!0),e(a).avatarUrl?(i(),d("div",ge,[u("img",{src:e(a).avatarUrl,alt:"Avatar Preview",class:"object-cover w-16 h-16 rounded-full"},null,8,ye)])):m("",!0)])):m("",!0),o(e(H),{type:"submit",class:"w-full"},{default:r(()=>[e(x)?(i(),d("span",be,[o(e(ee),{class:"w-4 h-4 mr-2 animate-spin"}),s[14]||(s[14]=c(" Processing... "))])):(i(),d("span",he,p(e(n)?"Create Account":"Sign In"),1))]),_:1})],32)]),_:1}),o(e(K),{class:"flex flex-col items-center justify-center p-6 pt-0"},{default:r(()=>[u("p",xe,[c(p(e(n)?"Already have an account?":"Don't have an account?")+" ",1),o(_,{to:e(n)?"/login":"/register",class:"font-medium text-primary hover:underline"},{default:r(()=>[c(p(e(n)?"Sign in":"Sign up"),1)]),_:1},8,["to"])])]),_:1})]),_:1})])])]),_:1})]),_:1})}}});export{Re as _};
